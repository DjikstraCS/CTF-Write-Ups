# Exercise 1 - Reverse Eng. Malware
 * Source: [KEA](https://kea.dk/)
 * Topic: Reverse Engineering
 * Date: 26-04-2022
 * Author: [DjikstraCS](https://github.com/DjikstraCS/CTF-Write-Ups)
---

## 1. Assembly:
![](./attachments/Pasted%20image%2020220426134334.png)

### Analysis:
1: Hent ram stack `[ebp-4]` og gem værdien `3`

2: Hent CPU register `eax` og gem værdien af RAM stack `[ebp-4]`.

3: Hent ram stack `[ebp-8]` og gem værdien af CPU register `eax`.

### 1.1 Reversing attempt:
#### Code:
```C++
int main(){
    int x=4; 
	int y=x;
    return 0;
}
```

#### IDA:
![](./attachments/Pasted%20image%2020220426181029.png)

---
## 2. Assembly:
![](./attachments/Pasted%20image%2020220426134806.png)

### Analysis:
1: Hent ram stack `[ebp-4]` og gem værdien `16h`

2: Hent RAM stack `[ebp-8]` og gem værdien `5h`.

3: Hent CPU register `eax` og gem værdien af RAM stack `[ebp-4]`.

4: Hent værdien af CPU register `eax` og lig værdien af RAM stack `[ebp-4]` til.

5: Hent RAM stack `[ebp-4]` og gem værdien af CPU register `eax`.

6: Hent CPU register `eax` og gem værdien af RAM stack `[ebp-4]`.

7: Hent værdien af CPU register `ecx` og træk værdien af RAM stack`[ebp-8]`  fra.

8: Hent RAM stack `[ebp-h10]` og gem værdien af CPU register `ecx`.

### 2.1 Reversing:
#### Code:

```C++
int main(){
    int x=4; 
	int y=6;
	int res = x + y;
	res = x - y;
    return 0;
}
```

#### IDA:
![](./attachments/Pasted%20image%2020220426151835.png)

---
## 3. Assembly:
![](./attachments/Pasted%20image%2020220426140331.png)

### Analysis:

1: Hent ram stack `[ebp-4]` og gem værdien `1`.

2: Hent ram stack `[ebp-4]` og sammenlign med værdi `0`.

3: Jump to location `loc_40101C` if `True`.

4: Hent CPU register `eax` og gem værdien af RAM stack `[ebp-4]`.

5: Hent værdien af CPU register `eax` og XOR med værdien `2`.

6: Hent RAM stack `[ebp-4]` og gem værdien af CPU register `eax`.

7: Jump to location `loc_401025`.

8: #

9: Location `loc_40101C`.

10: Hent CPU register `ecx` og gem værdien af RAM stack `[ebp-4]`.

11: Hent værdien af CPU register `eax` og XOR med værdien `3`.

12: Hent RAM stack `[ebp-4]` og gem værdien af CPU register `eax`.

13: #

14: Location `loc_401025`.

### 3.1 Reversing:
#### Code:
```C++
int x = 0;

int main(){
    if (x == false){
		x = x^2;
	}
	x = x^3;
    return 0;
}
```

#### IDA:
![](./attachments/Pasted%20image%2020220426190825.png)

---
## 4. Assembly:
![](./attachments/Pasted%20image%2020220426142014.png)

### Analysis:

1: Hent RAM stack `[ebp-8]` og gem værdien `1`.

1: Hent RAM stack `[ebp-4]` og gem værdien `0`.

3: #

4: Location `loc_401014`.

5: Hent RAM stack `[ebp-4]` og sammenlign med `[ebp-8]`.

6: Hop til `loc_40102E` hvis `[ebp-4]` er større eller lig med `4`.

7: Hent CPU register `eax` og gem værdien af RAM stack `[ebp-8]`.

8: Hent CPU register `eax` og lig værdien af RAM stack `[ebp-8]` til.

9: Hent RAM stack `[ebp-0]` og gem værdien af CPU register `eax`.

10: Hent CPU register `ecx` og gem værdien af RAM stack `[ebp-4]`.

11: Hent CPU register `ecx` og lig værdien `1` til.

12: Hent RAM stack `[ebp-4]` og gem værdien af CPU register `ecx`.

13: Hop til `loc_401014`.

### 4.1 Reversing:
#### Code:
```C++
int main(){
	int x = 1;
	int y = 0;
    if (y >= 4){
		return 0;
	}
	x = x + y;
	y = y + 1;
    return 0;
}
```

#### IDA:

---

Statisk
Dynamisk 
Code

