# GET aHEAD
* Source: PicoCTF
* Link: [PicoCTF.org](https://picoctf.org/)
* Challenge: GET aHEAD
* Category: Web Exploitation
* Points: 20
* Date: 02-04-2022
* Author: [DjikstraCS](https://github.com/DjikstraCS)

---
## Problem:
![](./attachments/Pasted%20image%2020220331010808.png)

---
## Hints:
1. Maybe you have more than 2 choices.
2. Check out tools like Burp suite to modify your requests and look at the responses.

---
## Solution:
Let's connect to the site.

![](./attachments/Pasted%20image%2020220402180116.png)

We get a red page with two buttons, if we click the blue button, the site turns blue.

We need to have a closer look at the requests with burp suite like hint 2. suggests.

In order to read the requests/responses the browser sends/receives, we need to proxy the traffic from the browser to Burp suite. For this we will use `localhost:8080` meaning that we will use the local host address (`127.0.0.1`) with a randomly selected port not used by any other protocol, in this case `8080`.

To do this in Firefox, we need to go to: 
Menu button -> Settings -> scroll down -> under network Settings, click 'Settings...' -> Select Manual Proxy and type in `localhost` and `8080`.

![](./attachments/Pasted%20image%2020220402181944.png)

Now it's time to fire up Burp Suite!

We need Burp Suite to act as a proxy server, when the program is open click on 'Proxy' tab and then Options.
Here we can see the intercept options. Make sure interception of 'Requests' and 'Responses' are both enabled and that all filters are turned off, like this:

![](./attachments/Pasted%20image%2020220402182211.png)

Now go to the intercept tab and turn interception on.

![](./attachments/Pasted%20image%2020220402184509.png)

Now everything is set up, and we are ready to capture some traffic.

If we go to the website and click one of the buttons, Burp will show us the request the browser is making.

![](./attachments/Pasted%20image%2020220402184700.png)

Note that the browser is making a `POST` request. Click 'Forward' to pass the request on to the web server.

Now we received the response to our request from the web server. Everything seems normal. If you want, you can try and change the color of the website by editing the HTML before passing it on to the browser, just for fun.

It's time for the red button.

![](./attachments/Pasted%20image%2020220402185324.png)

This time a `GET` request.

The hint 1. Says we have more than two choices. 

A search for 'HTTP methods' returns this:

![](./attachments/Pasted%20image%2020220402185754.png)

Source: [HTTP Request Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)

We have already seen `GET` and `POST`, but what about `HEAD`? If we go back into burp suite, we can try and modify the request, by changing `GET` to `HEAD`.

![](./attachments/Pasted%20image%2020220402190256.png)

Click on 'Forward' to pass the message on to the server.

![](./attachments/Pasted%20image%2020220402190731.png)

Voil√†! The response from the server contains the flag.


**Flag:** `picoCTF{r3j3ct_th3_du4l1ty_775f2530}`

---
## Alternate solution:
A more lightweight solution can be achieved with `curl`. It's a simple terminal tool for transferring data. It supports a vide range of different protocols, some better known are FTP, HTTP, SMTP, TELNET and SMB. In this case, we need it's HTTP/HTTPS capability. This simple line of code will send a `HEAD` request:

`curl -I HEAD -i http://mercury.picoctf.net:53554/index.php`

Again, the response contains the flag.

![](./attachments/Pasted%20image%2020220402192406.png)

**Flag:** `picoCTF{r3j3ct_th3_du4l1ty_775f2530}`

---
**Tags:** [[PicoCTF]] [[Bash]] [[HTTP]] [[GET]] [[POST]] [[HEAD]] [[Burp Suite]] [[proxy]] [[localhost]] [[port]] [[IP]] [[Intercept]] [[curl]] [[Firefox]] [[HTML]]