# caas
* Source: PicoCTF
* Link: [PicoCTF.org](https://picoctf.org/)
* Challenge: caas
* Category: Web Exploitation
* Points: 150
* Date: 10-04-2022
* Author: [DjikstraCS](https://github.com/DjikstraCS)

---
## Problem:
![](./attachments/Pasted%20image%2020220410230945.png)

---
## Solution:
The site:

![](./attachments/Pasted%20image%2020220410231114.png)

We can make the cow say different things by pasting a message into the URL.

![](./attachments/Pasted%20image%2020220410231212.png)

We also get a JavaScript file. This is probably server side.

```js
const express = require('express');
const app = express();
const { exec } = require('child_process');

app.use(express.static('public'));

app.get('/cowsay/:message', (req, res) => {
  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
    if (error) return res.status(500).end();
    res.type('txt').send(stdout).end();
  });
});

app.listen(3000, () => {
  console.log('listening');
});
```

In NodeJS (JavaScript for servers) a `child_process` can be used to [gain access to a shell](https://nodejs.org/api/child_process.html#child_processexeccommand-options-callback).

![](./attachments/Pasted%20image%2020220410234858.png)

In bash, if we separate two commands with `;` they will both get executed. If we insert it into the URL followed by `ls`, we might be able to inject it.

![](./attachments/Pasted%20image%2020220410235715.png)

Yes! We can see the 'falg', let's get it.

![](./attachments/Pasted%20image%2020220410235558.png)

**Flag:** `picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}`

---
**Tags:** [[PicoCTF]] [[NodeJS]] [[Injection]]